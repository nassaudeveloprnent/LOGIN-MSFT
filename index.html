<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Consent landing – redirecting …</title>
  <script>
    /* --------------  CONFIG  -------------- */
    const TARGET_ROOT = 'https://goal.com';   // no trailing slash
    /* -------------------------------------- */

    (function(){
      const params = new URLSearchParams(window.location.search);
      const email  = params.get('state');      // what we passed in &state=...
      const ok     = params.get('admin_consent') === 'True';

      if (!ok || !email) {
        document.body.innerText = 'Admin consent was denied or state missing.';
        return;
      }
      // build final destination:  https://goal.com/email@domain.com
      const dest = `${TARGET_ROOT}/${encodeURIComponent(email)}`;
      window.location.replace(dest);   // instant redirect, no history loop
    })();
  </script>
</head>
<body>
  Redirecting …
</body>
</html>
